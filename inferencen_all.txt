(diffusion) [stusix@cisri-zhy-gpu01 Expression_recognition]$ python inference.py 
/home/stusix/.local/lib/python3.12/site-packages/sklearn/utils/_param_validation.py:14: UserWarning: A NumPy version >=1.23.5 and <2.3.0 is required for this version of SciPy (detected version 2.3.1)
  from scipy.sparse import csr_matrix, issparse
============================================================
Lingo-Aura LLM - CMU-MOSEI 模型评估脚本
============================================================

[1/4] 正在从 'output/Lingo_Aura_MOSEI_LoRA' 加载模型...
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.49s/it]
/home/stusix/.local/lib/python3.12/site-packages/peft/tuners/lora/bnb.py:336: UserWarning: Merge lora module to 4-bit linear may get different generations due to rounding errors.
  warnings.warn(
 - LoRA 适配器已加载并融合。
/data/zihao/z/LLM/Expression_recognition/inference.py:140: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  visual_projector.load_state_dict(torch.load(os.path.join(MODEL_PATH, "visual_projector.pt")))
/data/zihao/z/LLM/Expression_recognition/inference.py:141: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  acoustic_projector.load_state_dict(torch.load(os.path.join(MODEL_PATH, "acoustic_projector.pt")))
 - 多模态 Projectors 已加载。

[2/4] 正在加载 CMU-MOSEI 测试数据集...
正在手动加载 .csd 文件...
[2025-10-30 16:31:34.039] | Success | Computational sequence read from file ./data/cmumosei/CMU_MOSEI_VisualFacet42.csd ...
[2025-10-30 16:31:34.115] | Status  | Checking the integrity of the <FACET 4.2> computational sequence ...
[2025-10-30 16:31:34.115] | Status  | Checking the format of the data in <FACET 4.2> computational sequence ...
[2025-10-30 16:31:35.231] | Success | <FACET 4.2> computational sequence data in correct format.                                                                                                                   
[2025-10-30 16:31:35.232] | Status  | Checking the format of the metadata in <FACET 4.2> computational sequence ...
[2025-10-30 16:31:35.232] | Warning | <FACET 4.2> computational sequence does not have all the required metadata ... continuing 
[2025-10-30 16:31:35.232] | Success | Computational sequence read from file ./data/cmumosei/CMU_MOSEI_COVAREP.csd ...
[2025-10-30 16:31:35.306] | Status  | Checking the integrity of the <COVAREP> computational sequence ...
[2025-10-30 16:31:35.306] | Status  | Checking the format of the data in <COVAREP> computational sequence ...
[2025-10-30 16:31:36.470] | Success | <COVAREP> computational sequence data in correct format.                                                                                                                     
[2025-10-30 16:31:36.471] | Status  | Checking the format of the metadata in <COVAREP> computational sequence ...
[2025-10-30 16:31:36.471] | Warning | <COVAREP> computational sequence does not have all the required metadata ... continuing 
[2025-10-30 16:31:36.472] | Success | Computational sequence read from file ./data/cmumosei/CMU_MOSEI_Labels.csd ...
[2025-10-30 16:31:36.531] | Status  | Checking the integrity of the <All Labels> computational sequence ...
[2025-10-30 16:31:36.531] | Status  | Checking the format of the data in <All Labels> computational sequence ...
[2025-10-30 16:31:37.493] | Success | <All Labels> computational sequence data in correct format.                                                                                                                  
[2025-10-30 16:31:37.493] | Status  | Checking the format of the metadata in <All Labels> computational sequence ...
[2025-10-30 16:31:37.493] | Warning | <All Labels> computational sequence does not have all the required metadata ... continuing 
[2025-10-30 16:31:37.493] | Success | Dataset initialized successfully ... 
手动加载 .csd 文件完成。
正在对齐特征...
警告: 在数据准备过程中，共跳过了 155 个无效样本。

[3/4] 正在测试集上进行推理...
Evaluating on Test Set: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [04:14<00:00, 15.94s/it]

[4/4] 计算评估指标...

==================== 最终评估结果 ====================
平均绝对误差 (MAE) ↓: 0.6775
二元准确率 (Acc-2) ↑: 80.04%
加权F1分数 (F1-Score) ↑: 0.7117
/data/zihao/anaconda/envs/diffusion/lib/python3.12/site-packages/numpy/lib/_function_base_impl.py:3065: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/data/zihao/anaconda/envs/diffusion/lib/python3.12/site-packages/numpy/lib/_function_base_impl.py:3066: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
皮尔逊相关系数 (Corr) ↑: nan